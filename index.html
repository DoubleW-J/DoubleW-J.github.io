<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ°¸ä½ç”³è«‹äºˆæ¸¬ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | Permanent Residency Forecast</title>
    <link
      rel="icon"
      href="https://cdn-icons-png.flaticon.com/512/428/428032.png"
    />
    <style>
      :root {
        --primary-color: #2c3e50;
        --accent-color: #3498db;
        --bg-color: #f8f9fa;
        --card-bg: #ffffff;
      }

      body {
        font-family:
          "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans",
          Meiryo, sans-serif;
        margin: 0;
        background-color: var(--bg-color);
        color: var(--primary-color);
        line-height: 1.6;
        overflow-x: hidden; /* ã‚¹ã‚±ãƒ¼ãƒ«èª¿æ•´ã«ã‚ˆã‚‹æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²æ­¢ */
      }

      .top-bar {
        height: 4px;
        background: linear-gradient(to right, var(--accent-color), #2ecc71);
      }

      header {
        background-color: var(--card-bg);
        padding: 40px 20px;
        text-align: center;
        border-bottom: 1px solid #eee;
      }

      header h1 {
        margin: 0;
        font-size: 2.2rem;
        letter-spacing: 1px;
      }

      header p {
        color: #7f8c8d;
        margin-top: 10px;
        font-weight: 300;
      }

      .main-content {
        max-width: 1400px;
        margin: 30px auto;
        padding: 0 20px;
      }

      .description-box {
        margin-bottom: 30px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }

      .info-item {
        background: #eef2f7;
        padding: 15px 20px;
        border-left: 4px solid var(--accent-color);
        border-radius: 4px;
        font-size: 0.9rem;
      }
      .viz-card {
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.05);
        padding: 0px;
        overflow: hidden;
        display: flex;
        justify-content: center;
        position: relative;
      }

      /* Tableauã‚³ãƒ³ãƒ†ãƒŠã®ç¸®æ”¾åŸºæº–ç‚¹ã‚’è¨­å®š */
      #vizContainer {
        transform-origin: top center;
        transition: transform 0.3s ease;
      }

      footer {
        text-align: center;
        padding: 40px 20px;
        color: #95a5a6;
        font-size: 0.85rem;
      }

      @media (max-width: 768px) {
        header h1 {
          font-size: 1.6rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="top-bar"></div>

    <header>
      <h1>Permanent Residency Forecast</h1>
      <p>æ—¥æœ¬æ°¸ä½è¨±å¯ç”³è«‹ã®å‹•å‘äºˆæ¸¬ãƒ»çµ±è¨ˆåˆ†æãƒãƒ¼ã‚¿ãƒ«</p>
    </header>

    <div class="main-content">
      <div class="description-box">
        <div class="info-item">
          <strong>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼š</strong>
          æ—¥æœ¬æ”¿åºœçµ±è¨ˆï¼ˆe-Statï¼‰ã®ã€Œå‡ºå…¥å›½ç®¡ç†çµ±è¨ˆã€ã«åŸºã¥ãã€æœ€æ–°ã®å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•åæ˜ ã€‚
        </div>
        <div class="info-item">
          <strong>ğŸ” åˆ†æå¯¾è±¡ï¼š</strong>
          å…¨å›½ãŠã‚ˆã³å„åœ°æ–¹å‡ºå…¥å›½åœ¨ç•™ç®¡ç†å±€åˆ¥ã®å—ç†ãƒ»è¨±å¯ãƒ»æœªæ¸ˆï¼ˆãƒãƒƒã‚¯ãƒ­ã‚°ï¼‰çŠ¶æ³ã‚’ç¶²ç¾…ã€‚
        </div>
        <div class="info-item">
          <strong>ğŸ“ˆ äºˆæ¸¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼š</strong>
          ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´ã«ã‚ˆã‚Šã€éå»ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã«åŸºã¥ã„ãŸä»Šå¾Œã®ç”³è«‹å‹•å‘ã‚’äºˆæ¸¬å¯èƒ½ã€‚
        </div>
      </div>

      <div class="viz-card">
        <div class="tableauPlaceholder" id="vizContainer">
          <div
            class="tableauPlaceholder"
            id="viz1770204389511"
            style="position: relative"
          >
            <noscript>
              <a href="#">
                <img
                  alt="Designed by Pradeep Kumar"
                  src="https://public.tableau.com/static/images/Su/SuperstoreDashboard-VizExtensionsEdition_VOTD_17702027410190/viz/1_rss.png"
                  style="border: none"
                />
              </a>
            </noscript>
            <object class="tableauViz" style="display: none">
              <param
                name="host_url"
                value="https%3A%2F%2Fpublic.tableau.com%2F"
              />
              <param name="embed_code_version" value="3" />
              <param name="site_root" value="" />
              <param
                name="name"
                value="SuperstoreDashboard-VizExtensionsEdition_VOTD_17702027410190&#47;viz"
              />
              <param name="tabs" value="no" />
              <param name="toolbar" value="yes" />
              <param
                name="static_image"
                value="https://public.tableau.com/static/images/Su/SuperstoreDashboard-VizExtensionsEdition_VOTD_17702027410190/viz/1.png"
              />
              <param name="animate_transition" value="yes" />
              <param name="display_static_image" value="yes" />
              <param name="display_spinner" value="yes" />
              <param name="display_overlay" value="yes" />
              <param name="display_count" value="yes" />
              <param name="language" value="zh-CN" />
              <param name="filter" value="publish=yes" />
            </object>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>
        &copy; 2026 PR Forecast Project. Data synced via Tableau Public API.
      </p>
      <p>
        å‡ºå…¥å›½ç®¡ç†çµ±è¨ˆã®ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã—ã€ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚
      </p>
    </footer>

    <script type="text/javascript">
      /**
       * Tableauãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ã™ã‚‹é–¢æ•°
       */
      function resizeTableau() {
        // .viz-cardã®å¹…ã‚’å–å¾—ï¼ˆå·¦å³ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è€ƒæ…®ï¼‰
        var vizCard = document.querySelector(".viz-card");
        var containerWidth = vizCard.offsetWidth - 40;

        var vizContainer = document.getElementById("vizContainer");
        var divElement = document.getElementById("viz1770204389511");
        var vizElement = divElement.getElementsByTagName("object")[0];

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚µã‚¤ã‚º
        var originalWidth = 1400;
        var originalHeight = 1627;

        // ã€ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆã€‘
        // ç¼©æ”¾æ¯”ä¾‹ï¼šå¦‚æœå®¹å™¨å¤ªçª„ï¼Œåˆ™è¿›è¡Œç¼©å°ã€‚
        // ä½†å¦‚æœå®¹å™¨è¶³å¤Ÿå®½ï¼Œæˆ‘ä»¬é™åˆ¶å®ƒä¸è¦ç¼©å¾—å¤ªå°ã€‚
        var scale = containerWidth / originalWidth;

        // é™åˆ¶ï¼šåœ¨PCç«¯å¦‚æœscaleç®—å‡ºæ¥æ˜¯0.5ï¼ˆå¤ªå°ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®è°ƒå¤§ä¸€ç‚¹
        // æˆ–è€…ç¡®ä¿å®¹å™¨æœ¬èº«åœ¨CSSé‡Œè¶³å¤Ÿå®½
        if (scale > 1) scale = 1;

        // å…¨ä½“ã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
        vizContainer.style.transform = "scale(" + scale + ")";

        // ã€é‡è¦ã€‘ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å¾Œã®é«˜ã•ã‚’è¦ªå®¹å™¨ã«åæ˜ 
        // ã“ã‚Œã‚’ã—ãªã„ã¨ã€ä¸‹ã®ãƒ•ãƒƒã‚¿ãƒ¼ã¨ã®é–“ã«å·¨å¤§ãªç©ºç™½ãŒã§ããŸã‚Šã€ä¸­èº«ãŒåˆ‡ã‚ŒãŸã‚Šã—ã¾ã™
        vizCard.style.height = originalHeight * scale + 60 + "px";

        // Tableauã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚µã‚¤ã‚ºè¨­å®š
        vizElement.style.width = originalWidth + "px";
        vizElement.style.height = originalHeight + "px";
      }

      // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒªã‚µã‚¤ã‚ºæ™‚ã«å®Ÿè¡Œ
      window.onresize = resizeTableau;

      // åˆæœŸåŒ–
      var divElement = document.getElementById("viz1770204389511");
      var vizElement = divElement.getElementsByTagName("object")[0];

      // åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚
      resizeTableau();

      var scriptElement = document.createElement("script");
      scriptElement.src =
        "https://public.tableau.com/javascripts/api/viz_v1.js";
      vizElement.parentNode.insertBefore(scriptElement, vizElement);
    </script>
  </body>
</html>
